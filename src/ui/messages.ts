import { EMOJIS } from '../utils/constants';

/**
 * –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏–π UI
 * –£—Å—Ç—Ä–∞–Ω—è–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ
 */

/**
 * –ë–∞–∑–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π
 */
export class MessageFormatter {
    /**
     * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
     */
    static success(message: string): string {
        return `‚úÖ ${message}`;
    }

    /**
     * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
     */
    static error(message: string): string {
        return `‚ùå ${message}`;
    }

    /**
     * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
     */
    static info(message: string, emoji?: string): string {
        const icon = emoji || '‚ÑπÔ∏è';
        return `${icon} ${message}`;
    }

    /**
     * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫
     */
    static header(title: string, emoji?: string): string {
        const icon = emoji || 'üìã';
        return `${icon} ${title}`;
    }

    /**
     * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫
     */
    static list(items: string[], numbered: boolean = false): string {
        return items
            .map((item, index) =>
                numbered ? `${index + 1}. ${item}` : `‚Ä¢ ${item}`
            )
            .join('\n');
    }
}

/**
 * –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è UI
 */
export const UI_TEXTS = {
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è
    navigation: {
        home: 'üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é',
        back: '‚¨ÖÔ∏è –ù–∞–∑–∞–¥',
        cancel: '‚ùå –û—Ç–º–µ–Ω–∏—Ç—å',
        goingHome: '–í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω',
        unknownCommand: '–Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é.',
        useButtons: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.',
    },

    // –û–±—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    common: {
        loading: '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...',
        success: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
        error: '‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞',
        tryAgain: '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.',
        initialized: '‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ',
        notImplemented: '–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö.',
    },

    // –ö–æ—Ä–º–ª–µ–Ω–∏–µ
    feeding: {
        buttonText: `${EMOJIS.FEED} –°–æ–±–∞—á–∫–∞ –ø–æ–µ–ª`,
        success: 'üçΩÔ∏è –°–æ–±–∞—á–∫–∞ –≤–∫—É—Å–Ω–æ –ø–æ–µ–ª!',
        recordedSuccess: '‚úÖ –ö–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ!\n\n–ß—Ç–æ –¥–∞–ª—å—à–µ?',
        detailsButton: 'üìù –£—Ç–æ—á–Ω–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ—Ä–º–ª–µ–Ω–∏—è',
        detailsPrompt:
            'üìù *–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∫–æ—Ä–º–ª–µ–Ω–∏–µ*\n\n' +
            '–ï—Å–ª–∏ –Ω–∞–¥–æ, –ø–æ–º–µ–Ω—è–π—Ç–µ —Ç–∏–ø –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–º–∞:\n' +
            '‚Ä¢ 50–≥ —Å—É—Ö–æ–≥–æ\n' +
            '‚Ä¢ 60 –≤–ª–∞–∂–Ω–æ–≥–æ\n' +
            '‚Ä¢ —Å—É—Ö–æ–≥–æ 40–≥\n\n' +
            '–ò–ª–∏ –∑–∞–ø–∏—à–∏—Ç–µ –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è –∫–æ—Ä–º–ª–µ–Ω–∏—è:\n' +
            '‚Ä¢ 14:30\n' +
            '‚Ä¢ 9:15\n\n' +
            '–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—à–∏—Ç–µ —Ö–æ—Ä–æ—à—É—é –º—ã—Å–ª—å –ø—Ä–æ –Ω–∞—à—É —Å–æ–±–∞—á–∫—É, –∏ –æ–Ω–∞ (–º—ã—Å–ª—å) –ø—Ä–∏–≤—è–∂–µ—Ç—Å—è –∫ —ç—Ç–æ–º—É –∫–æ—Ä–º–ª–µ–Ω–∏—é :)',
        detailsUpdated: '‚úÖ –î–µ—Ç–∞–ª–∏ –∫–æ—Ä–º–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã!',
        detailsError: '–û—à–∏–±–∫–∞: –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∫–æ—Ä–º–ª–µ–Ω–∏–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è',
        noRecentFeeding:
            '–ê –≤—ã –Ω–µ –ø–æ–∫–æ—Ä–º–∏–ª–∏ —Å–æ–±–∞—á–∫—É —Ç–æ–ª—å–∫–æ —á—Ç–æ? –°—Ç—Ä–∞–Ω–Ω–æ. –ê —á—Ç–æ –∂–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ç–æ–≥–¥–∞ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å? :)',
        stopped: '‚èπÔ∏è –ö–æ—Ä–º–ª–µ–Ω–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã',
        resumed: '‚ñ∂Ô∏è –ö–æ—Ä–º–ª–µ–Ω–∏—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω—ã',
        stopPrompt: '–ß—Ç–æ–±—ã –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –∫–æ—Ä–º–ª–µ–Ω–∏—è, –Ω–∞–∂–º–∏—Ç–µ "üçΩÔ∏è –°–æ–±–∞—á–∫–∞ –ø–æ–µ–ª"',
    },

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    settings: {
        header: '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏\n\n–í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:',
        foodHeader: 'üçΩÔ∏è –∫–æ—Ä–º',
        intervalHeader: '‚è∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª',
        notificationsHeader: 'üîî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
        foodUpdated: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ—Ä–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!',
        intervalUpdated: '–ò–Ω—Ç–µ—Ä–≤–∞–ª –∫–æ—Ä–º–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω!',
        changesApplied:
            '–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É –ø–æ—Å–ª–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ—Ä–º–ª–µ–Ω–∏—è.',
    },

    // –ò—Å—Ç–æ—Ä–∏—è
    history: {
        header: 'üìã –ò—Å—Ç–æ—Ä–∏—è\n\n–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:',
        todayHeader: 'üìÖ –ò—Å—Ç–æ—Ä–∏—è –∑–∞ —Å–µ–≥–æ–¥–Ω—è',
        fullHeader: 'üìã –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∫–æ—Ä–º–ª–µ–Ω–∏–π',
        noFeedings: 'üîç –ö–æ—Ä–º–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞',
        loading: '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏...',
    },

    // –≠–∫—Å–ø–æ—Ä—Ç
    export: {
        header: 'üì§ –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ—Ä–º–ª–µ–Ω–∏–π\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∏ –ø–µ—Ä–∏–æ–¥:',
        success: '‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!',
        error: '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö',
        selectFormat: '‚ùå –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞.',
        csvSelected: 'üìã –í—ã–±—Ä–∞–Ω CSV —Ñ–æ—Ä–º–∞—Ç\n\n–¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞:',
        htmlSelected: 'üåê –í—ã–±—Ä–∞–Ω HTML —Ñ–æ—Ä–º–∞—Ç\n\n–¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞:',
    },

    // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    welcome:
        '–ü—Ä–∏–≤–µ—Ç! üêï\n\n' +
        '–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–º–æ–∂–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–º–ª–µ–Ω–∏–µ —Å–æ–±–∞–∫–∏.\n' +
        '–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:',

    // –°—Ç–∞—Ç—É—Å
    status: {
        header: 'üìä –°—Ç–∞—Ç—É—Å –∫–æ—Ä–º–ª–µ–Ω–∏—è:\n\n',
        lastFeeding: 'üçΩÔ∏è –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∫–æ—Ä–º–ª–µ–Ω–∏–µ:',
        noFeedings: 'üçΩÔ∏è –ö–æ—Ä–º–ª–µ–Ω–∏–π –µ—â–µ –Ω–µ –±—ã–ª–æ\n\n',
        nextFeeding: '‚è∞ –°–ª–µ–¥—É—é—â–µ–µ –∫–æ—Ä–º–ª–µ–Ω–∏–µ',
        interval: '‚è∞ –ò–Ω—Ç–µ—Ä–≤–∞–ª –∫–æ—Ä–º–ª–µ–Ω–∏—è',
        paused: '‚èπÔ∏è –ö–æ—Ä–º–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã',
        statistics: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:',
    },

    // –û—à–∏–±–∫–∏
    errors: {
        databaseNotInitialized:
            '–û—à–∏–±–∫–∞: –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π /start',
        servicesNotInitialized:
            '–û—à–∏–±–∫–∞: —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π /start',
        timerNotInitialized:
            '–û—à–∏–±–∫–∞: —Å–µ—Ä–≤–∏—Å —Ç–∞–π–º–µ—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π /start',
        userNotFound: '–û—à–∏–±–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω',
        generic: '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.',
    },
};

/**
 * –°—Ç—Ä–æ–∏—Ç–µ–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
 */
export class MessageBuilder {
    /**
     * –°–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∫–æ—Ä–º–ª–µ–Ω–∏–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏
     */
    static feedingNotification(params: {
        timestamp: string;
        username: string;
        amount: number;
        foodType: string;
        nextFeedingTime?: string;
        interval?: string;
    }): string {
        const { timestamp, username, amount, foodType, nextFeedingTime, interval } = params;

        const foodTypeRu = foodType === 'dry' ? '—Å—É—Ö–æ–≥–æ' : '–≤–ª–∞–∂–Ω–æ–≥–æ';

        let message =
            `${UI_TEXTS.feeding.success}\n\n` +
            `${timestamp}\n` +
            `${username} –¥–∞–ª ${amount}–≥ ${foodTypeRu} –∫–æ—Ä–º–∞\n`;

        if (nextFeedingTime && interval) {
            message += `\n‚è∞ –°–ª–µ–¥—É—é—â–µ–µ –∫–æ—Ä–º–ª–µ–Ω–∏–µ –≤ ${nextFeedingTime} (—á–µ—Ä–µ–∑ ${interval})`;
        }

        return message;
    }

    /**
     * –°–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∫–æ—Ä–º–ª–µ–Ω–∏–π
     */
    static feedingStopped(initiatorUsername: string): string {
        return (
            `${UI_TEXTS.feeding.stopped}\n` +
            `–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä: ${initiatorUsername}\n\n` +
            `${UI_TEXTS.feeding.stopPrompt}`
        );
    }

    /**
     * –°–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
     */
    static currentSettings(params: {
        type: string;
        amount: string;
    }): string {
        const typeText = params.type === 'dry' ? '–°—É—Ö–æ–π' : '–í–ª–∞–∂–Ω—ã–π';

        return (
            `–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:\n` +
            `‚Ä¢ –¢–∏–ø –∫–æ—Ä–º–∞: ${typeText}\n` +
            `‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${params.amount} –≥—Ä–∞–º–º–æ–≤`
        );
    }

    /**
     * –°–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
     */
    static settingsUpdated(
        header: string,
        updates: string[],
        initiator?: string
    ): string {
        let message =
            `${MessageFormatter.success(header)}\n\n` +
            `–ù–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: ${updates.join(', ')}\n\n` +
            `${UI_TEXTS.settings.changesApplied}`;

        if (initiator) {
            message += `\n–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä: ${initiator}`;
        }

        return message;
    }
}
